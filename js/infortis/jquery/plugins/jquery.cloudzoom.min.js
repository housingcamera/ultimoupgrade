(function(b){function t(b){for(var d=1;d<arguments.length;d++)b=b.replace("%"+(d-1),arguments[d]);return b}function I(f,d){var c=b("img.visible",f),l,h=null,n=null,e=null,k=null,p=null,m=null,u,D=0,v,w,E=0,F=0,z=0,A=0,G=0,B,C,q=this,H;setTimeout(function(){if(null===n){var c=f.width();f.parent().append(t('<div style="width:%0px;position:absolute;top:75%;left:%1px;text-align:center" class="cloud-zoom-loading" >Loading...</div>',c/3,c/2-c/6));b("cloud-zoom-loading",f.parent()).css("opacity",.5)}},200);
this.removeBits=function(){e&&(e.remove(),e=null);k&&(k.remove(),k=null);p&&(p.remove(),p=null);null!==m&&(m.remove(),m=null);b(".cloud-zoom-loading",f.parent()).remove()};this.destroy=function(){f.data("zoom",null);n&&(n.unbind(),n.remove(),n=null);h&&(h.remove(),h=null);this.removeBits()};this.fadedOut=function(){h&&(h.remove(),h=null);this.removeBits()};this.controlLoop=function(){if(e){var b=B-c.offset().left-.5*v>>0,g=C-c.offset().top-.5*w>>0;0>b?b=0:b>c.outerWidth()-v&&(b=c.outerWidth()-v);
0>g?g=0:g>c.outerHeight()-w&&(g=c.outerHeight()-w);e.css({left:b,top:g});e.css("background-position",-b+"px "+-g+"px");E=b/c.outerWidth()*u.width>>0;F=g/c.outerHeight()*u.height>>0;A+=(E-A)/d.smoothMove;z+=(F-z)/d.smoothMove;h.css("background-position",-(A>>0)+"px "+(-(z>>0)+"px"))}D=setTimeout(function(){q.controlLoop()},30)};this.init2=function(b,c){G++;1===c&&(u=b);2===G&&this.init()};this.init=function(){b(".cloud-zoom-loading",f.parent()).remove();var l=b("<div class='mousetrap' style='background-image:url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)'></div>");
n=f.parent().append(l).find(":last");n=b(".mousetrap",f.parent());n.css({width:c.outerWidth(),height:c.outerHeight(),top:0,left:0,position:"absolute",zIndex:9999});n.bind("mousemove",this,function(b){B=b.pageX;C=b.pageY});n.bind("mouseleave",this,function(b){clearTimeout(D);e&&e.fadeOut(299);k&&k.fadeOut(299);p&&p.fadeOut(299);h.fadeOut(300,function(){q.fadedOut()});return!1});n.bind("mouseenter",this,function(g){B=g.pageX;C=g.pageY;H=g.data;h&&(h.stop(!0,!1),h.remove());g=d.adjustX;var l=d.adjustY,
m=c.outerWidth(),q=c.outerHeight(),x=d.zoomWidth,y=d.zoomHeight;"auto"==d.zoomWidth&&(x=m);"auto"==d.zoomHeight&&(y=q);var r=f.parent();switch(d.position){case "top":l-=y;break;case "right":g+=m;break;case "bottom":l+=q;break;case "left":g-=x;break;case "inside":x=m;y=q;break;default:r=b("#"+d.position),r.length?(x=r.innerWidth(),y=r.innerHeight()):(r=f,g+=m,l+=q)}h=r.append(t('<div id="cloud-zoom-big" class="cloud-zoom-big" style="display:none;position:absolute;left:%0px;top:%1px;width:%2px;height:%3px;background-image:url(\'%4\');z-index:99;"></div>',
g,l,x,y,u.src)).find(":last");h=b(".cloud-zoom-big",r);c.attr("title")&&d.showTitle&&(h.append(t('<div class="cloud-zoom-title">%0</div>',c.attr("title"))),b(".cloud-zoom-title",h).css("opacity",d.titleOpacity));h.fadeIn(500);e&&(e.remove(),e=null);v=c.outerWidth()/u.width*h.width();w=c.outerHeight()/u.height*h.height();e=f.append(t("<div class = 'cloud-zoom-lens' style='display:none;z-index:98;position:absolute;width:%0px;height:%1px;'></div>",v,w)).find(":last");e=b(".cloud-zoom-lens",f);n.css("cursor",
e.css("cursor"));g=!1;d.tint&&(e.css("background",'url("'+c.attr("src")+'")'),k=f.append(t('<div class="cloud-zoom-tint" style="display:none;position:absolute; left:0px; top:0px; width:%0px; height:%1px; background-color:%2;" />',c.outerWidth(),c.outerHeight(),d.tint)).find(":last"),k=b(".cloud-zoom-tint",f),k.css("opacity",d.tintOpacity),g=!0,k.fadeIn(500));d.softFocus&&(e.css("background",'url("'+c.attr("src")+'")'),f.append(t('<div class="cloud-zoom-soft" style="position:absolute;display:none;top:2px; left:2px; width:%0px; height:%1px;" />',
c.outerWidth()-2,c.outerHeight()-2,d.tint)),p=b(".cloud-zoom-soft",f),p.css("background",'url("'+c.attr("src")+'")'),p.css("opacity",.5),g=!0,p.fadeIn(500));g||e.css("opacity",d.lensOpacity);"inside"!==d.position&&e.fadeIn(500);H.controlLoop()})};l=new Image;b(l).load(function(){q.init2(this,0)});l.src=c.attr("src");l=new Image;b(l).load(function(){q.init2(this,1)});l.src=f.attr("href")}var m=document.getElementsByTagName("script"),J=m[m.length-1].src.lastIndexOf("/");m[m.length-1].src.slice(0,J);
b(document).ready(function(){b(".cloud-zoom, .cloud-zoom-gallery").CloudZoom()});b.fn.CloudZoom=function(f){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(d){}this.each(function(){var d,c;eval("var\ta = {"+b(this).attr("rel")+"}");d=a;b(this).is(".cloud-zoom")?(b(this).css({position:"relative",display:"block"}),b("img",b(this)).css({display:"block"}),"wrap"!=b(this).parent().attr("id")&&b(this).wrap('<div id="wrap" style="top:0px;z-index:9999;position:relative;"></div>'),c=b.extend({},
b.fn.CloudZoom.defaults,f),c=b.extend({},c,d),b(this).data("zoom",new I(b(this),c))):b(this).is(".cloud-zoom-gallery")&&(c=b.extend({},d,f),b(this).data("relOpts",c),b(this).bind("click",b(this),function(c){var d=c.data.data("relOpts"),f=c.data.data("relOpts").smallImage,e=b("#"+d.useZoom);$images=b("#"+d.useZoom+" img");$firstImage=$images.eq(0);d=!0;$firstImage.hasClass("visible")&&(d=!1);e.data("zoom").destroy();e.attr("href",c.data.attr("href"));if(d){var k=b('<img class="gallery-image" />');
k.attr("src",f);e.addClass("loading");$firstImage.remove();e.prepend(k);imagesLoaded(k,function(){e.removeClass("loading");$images.removeClass("visible");k.addClass("visible");e.CloudZoom()})}else $images.removeClass("visible"),$firstImage.attr("src",f),$firstImage.addClass("visible"),e.CloudZoom();return!1}))});return this};b.fn.CloudZoom.defaults={zoomWidth:"auto",zoomHeight:"auto",position:"right",tint:!1,tintOpacity:.5,lensOpacity:.5,softFocus:!1,smoothMove:3,showTitle:!0,titleOpacity:.5,adjustX:0,
adjustY:0}})(jQuery);